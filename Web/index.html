<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>RoomPingPro1</title>
</head>
<body>
    <div class="app-container">
        <div id="firewall-banner" class="firewall-banner" role="status">
            <span>When your firewall asks to allow this app, choose <strong>Allow</strong> (Private networks) so pings and discovery work. If you already blocked it, add RoomPingPro1 in Windows Security ‚Üí Firewall ‚Üí Allow an app.</span>
            <button type="button" class="firewall-dismiss" id="btn-dismiss-firewall" aria-label="Dismiss">√ó</button>
        </div>
        <div class="app-body">
        <header>
            <div class="header-top">
                <h1>RoomPingPro1</h1>
                <div style="display:flex; gap:4px;">
                    <button class="icon-btn" type="button" id="btn-refresh-status" title="Refresh online status">üîÑ</button>
                    <button class="icon-btn" type="button" id="btn-settings">‚öôÔ∏è</button>
                </div>
            </div>
        
            <div id="my-profile" class="my-profile-card">
                <div class="profile-info">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span class="label">My Device</span>
                        <button class="test-btn" type="button" id="btn-test-ping">Test Ping ‚ö°</button>
                    </div>
                    <h2 id="my-name">Detecting...</h2>
                    <div style="display:flex; align-items:center; gap:10px;">
                        <code style="color: #ff4b2b;">MAC: <span id="my-mac">--:--:--</span></code>
                        <button type="button" class="copy-btn" id="btn-copy-mac">üìã</button>
                    </div>
                    <p id="my-network" class="network-hint" style="margin:8px 0 0; font-size:11px; color:#888;"></p>
                </div>
            </div>
        </header>
    
        <div class="main-scroll">
            <section id="on-the-network" class="network-section">
                <h3 class="section-title">On the network</h3>
                <p class="section-hint">People running RoomPing Pro nearby. Add as friend to ping them easily next time.</p>
                <div id="discovered-list"></div>
            </section>
            <section id="friends-section">
                <h3 class="section-title">Friends</h3>
                <div id="friends-list"></div>
            </section>
        </div>
    
        <footer>
            <button class="add-btn" type="button" id="btn-add-roommate">+ Add Roommate</button>
            <button type="button" class="console-btn" id="btn-console-toggle" title="Show console log for debugging">Console</button>
        </footer>
        </div>

        <div id="console-wrap" class="console-wrap" hidden>
            <div class="console-resize-handle" id="console-resize-handle" title="Drag to resize"></div>
            <div class="console-header">
                <span class="console-title">Console log</span>
                <button type="button" class="console-close" id="btn-console-close" title="Close">√ó</button>
                <button type="button" class="console-clear" id="btn-console-clear">Clear</button>
            </div>
            <div class="console-content" id="console-content"></div>
        </div>

        <div id="modal-overlay" class="modal-overlay" style="display:none;">
            <div class="modal">
                <h2>Add Roommate</h2>
                <label for="new-name">Name</label>
                <input type="text" id="new-name" placeholder="e.g. Alex">
                <label for="new-mac">MAC Address (we'll find their IP from this)</label>
                <input type="text" id="new-mac" placeholder="e.g. 50:eb:f6:7f:bf:8d" title="Enter the device MAC address, not the IP. The app finds the IP when on the same network.">
                <label for="new-ip">IP address (optional ‚Äì use if device is online but scan can't find it)</label>
                <input type="text" id="new-ip" placeholder="e.g. 192.168.1.42">
                <div class="modal-buttons">
                    <button type="button" class="cancel-btn" id="btn-modal-cancel">Cancel</button>
                    <button type="button" class="save-btn" id="btn-modal-add">Add</button>
                </div>
            </div>
        </div>

        <div id="ip-modal" class="modal-overlay" style="display:none;">
            <div class="modal">
                <h2>Edit IP address</h2>
                <p id="ip-modal-desc" style="font-size:11px; color:#888; margin-top:0; margin-bottom:8px;"></p>
                <label for="ip-modal-ip">IP address</label>
                <input type="text" id="ip-modal-ip" placeholder="e.g. 192.168.1.42">
                <div class="modal-buttons">
                    <button type="button" class="cancel-btn" id="btn-ip-cancel">Cancel</button>
                    <button type="button" class="save-btn" id="btn-ip-save">Save</button>
                </div>
            </div>
        </div>

        <div id="settings-modal" class="modal-overlay" style="display:none;">
            <div class="modal">
                <h2>Settings</h2>
                <div class="setting-item setting-item-block">
                    <label for="display-name-input">Display name</label>
                    <input type="text" id="display-name-input" placeholder="e.g. Alex's laptop" title="How you appear when others discover you on the network">
                    <p class="setting-hint">This is how others see you when they find you on the network.</p>
                </div>
                <div class="setting-item">
                    <label>Audio Alerts</label>
                    <input type="checkbox" id="audio-toggle" checked onchange="toggleAudio()">
                </div>
                <div class="setting-item">
                    <label>Show Console Log</label>
                    <input type="checkbox" id="console-enabled-toggle" onchange="toggleConsoleEnabled()">
                </div>
                <div class="firewall-help">
                    <strong>Pings or discovery not working?</strong> Allow this app for <strong>Private</strong> networks (UDP 5005 for pings, 5006 for discovery). Windows: Security ‚Üí Firewall ‚Üí Allow an app ‚Üí add RoomPingPro1 and check Private.
                </div>
                <div class="setting-item">
                    <button type="button" class="save-btn" id="btn-check-updates" style="width:100%;">Check for updates</button>
                </div>
                <button type="button" class="save-btn" id="btn-settings-close">Close</button>
            </div>
        </div>
    </div>

    <audio id="ping-sound" src="assets/alert.mp3"></audio>

    <script src="script.js"></script>
</body>
</html>